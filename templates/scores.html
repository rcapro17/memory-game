<!-- =========================
     templates/scores.html
     ========================= -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Top Scores</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
    <link rel="stylesheet" href="static/css/scores.css" />
  </head>
  <body>
    <div class="container">
      <div class="navbar-main">
        <a href="#">Sobre o Jogo</a>
        <a href="/">Retornar ao Menu</a>
      </div>

      <h1 class="my-4 text-center">Top 10 Scores</h1>
      <div id="scores-container" class="d-flex flex-wrap"></div>
    </div>

    <script>
      // Atualizado: temas vÃ¡lidos + "Digital Devices"
      const themes = [
        "Elementos",
        "Estados",
        "Icones",
        "Relevos",
        "Rios",
        "Digital Devices",
      ];

      themes.forEach((theme) => {
        fetch(`/get_rankings?theme=${encodeURIComponent(theme)}`)
          .then((response) => response.json())
          .then((data) => {
            const tableContainer = document.createElement("div");
            tableContainer.classList.add("col-md-6", "mb-4");

            const getName = (row) => (row?.name ? row.name : row[0]);
            const getTime = (row) => (row?.time ? row.time : row[1]);

            const rows =
              !data || data.length === 0
                ? '<tr><td colspan="3">No records yet</td></tr>'
                : data
                    .map(
                      (score, index) => `
                        <tr>
                          <td>${index + 1}</td>
                          <td>${getName(score)}</td>
                          <td>${getTime(score)}</td>
                        </tr>
                      `,
                    )
                    .join("");

            tableContainer.innerHTML = `
              <h2>${theme}</h2>
              <table class="table table-striped">
                <thead>
                  <tr>
                    <th>Rank</th>
                    <th>Player</th>
                    <th>Time</th>
                  </tr>
                </thead>
                <tbody>
                  ${rows}
                </tbody>
              </table>
            `;

            document
              .getElementById("scores-container")
              .appendChild(tableContainer);
          })
          .catch((error) => {
            console.error("Error fetching scores:", error);
          });
      });
    </script>
  </body>
</html>
